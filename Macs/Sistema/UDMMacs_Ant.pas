unit UDMMacs;

interface

uses
  Windows, Messages, SysUtils, Classes, Graphics, Controls, Forms, Dialogs,
  Db, IBDatabase, IBCustomDataSet, IBUpdateSQL, IBQuery, IBEvents,
  IBSQLMonitor, FR_DSet, FR_DBSet, FR_Class;

type
  TDMMACS = class(TDataModule)
    TLojaAc: TIBQuery;
    DSLojaAc: TDataSource;
    TUsuario: TIBQuery;
    UPUsuario: TIBUpdateSQL;
    DSUsuario: TDataSource;
    TALX: TIBQuery;
    DSALX: TDataSource;
    TLojaUsu: TIBQuery;
    UPLojaUsu: TIBUpdateSQL;
    DSLojaUsu: TDataSource;
    TEmpAc: TIBQuery;
    DSEmpAc: TDataSource;
    DataBase: TIBDatabase;
    TExiste: TIBQuery;
    DSExiste: TDataSource;
    TSelect: TIBQuery;
    DSSelect: TDataSource;
    TCodigo: TIBQuery;
    UPCodigo: TIBUpdateSQL;
    DSCodigo: TDataSource;
    IBTCodigo: TIBTransaction;
    TLojaUsuCOD_LOJAACES: TIntegerField;
    TLojaUsuCOD_LOJA: TIntegerField;
    TLojaUsuCOD_USUARIO: TIntegerField;
    TLojaUsuUSUPERMI: TIntegerField;
    TLojaUsuCADCLI: TIBStringField;
    TLojaUsuEXCLCLI: TIBStringField;
    TLojaUsuLIBERACRED: TIBStringField;
    TLojaUsuCAD_USUARIO: TIBStringField;
    TLojaUsuCAD_CR: TIBStringField;
    TLojaUsuBAIXAR_CR: TIBStringField;
    TLojaUsuALTEXC_CR: TIBStringField;
    TLojaUsuCANCELBAIXA_CR: TIBStringField;
    TLojaUsuCAD_CP: TIBStringField;
    TLojaUsuBAIXA_CP: TIBStringField;
    TLojaUsuALTEXC_CP: TIBStringField;
    TLojaUsuCANCELBAIXA_CP: TIBStringField;
    TLojaUsuCADCX: TIBStringField;
    TLojaUsuABRIRCX: TIBStringField;
    TLojaUsuLANCX: TIBStringField;
    TLojaUsuFECHCX: TIBStringField;
    TLojaUsuCADVEN: TIBStringField;
    TLojaUsuCADCOTA: TIBStringField;
    TLojaUsuPRODUTOS: TIBStringField;
    TLojaUsuPDV: TIBStringField;
    TLojaUsuPEDVEN: TIBStringField;
    TLojaUsuORCAMENTO: TIBStringField;
    TLojaUsuALTPED: TIBStringField;
    TLojaUsuACERTESTOQUE: TIBStringField;
    TLojaUsuVENDATACADO: TIBStringField;
    TLojaUsuVENDAVAREJO: TIBStringField;
    TLojaUsuRELVENDCOM: TIBStringField;
    TLojaUsuMOVBANCO: TIBStringField;
    TLojaUsuCADCTACORRENTE: TIBStringField;
    TLojaUsuCANCVEND: TIBStringField;
    TLojaUsuCADFORNEC: TIBStringField;
    TLojaUsuEXCLFORNEC: TIBStringField;
    TLojaUsuCADPLANOCTA: TIBStringField;
    TLojaUsuCADFUNC: TIBStringField;
    TLojaUsuALTSALFUNC: TIBStringField;
    TLojaUsuCADFORMPAG: TIBStringField;
    TLojaUsuDESCPROD: TIBStringField;
    TLojaUsuEXCVENDEDOR: TIBStringField;
    TLojaUsuCADEMPRESA: TIBStringField;
    TLojaUsuCADLOJA: TIBStringField;
    TLojaUsuALTPEDCOMP: TIBStringField;
    TLojaUsuCADPEDCOMP: TIBStringField;
    TLojaUsuCANCCOMPRA: TIBStringField;
    TLojaUsuCADMOEDA: TIBStringField;
    TLojaUsuEFETUARCOMPRA: TIBStringField;
    TLojaUsuEMITDOCFISC: TIBStringField;
    TLojaUsuRFINEST: TIBStringField;
    TLojaUsuRPEDVEN: TIBStringField;
    TLojaUsuRPEDCOMP: TIBStringField;
    TLojaUsuRCAIXA: TIBStringField;
    TLojaUsuRBANCO: TIBStringField;
    TLojaUsuRCTAPAGAR: TIBStringField;
    TLojaUsuRCTARECEBER: TIBStringField;
    TLojaUsuALTLANCX: TIBStringField;
    TLojaUsuCONFIGLOJA: TIBStringField;
    TLojaUsuTROCVEND: TIBStringField;
    TLojaUsuPEDVENDA: TIBStringField;
    TLojaUsuCADSERV: TIBStringField;
    DBTrill: TIBDatabase;
    IBTTRILL: TIBTransaction;
    BASE: TIBQuery;
    UPBASE: TIBUpdateSQL;
    DSBase: TDataSource;
    TLojaUsuABRIRORD: TIBStringField;
    TLojaUsuFECHORD: TIBStringField;
    TLojaUsuEXCORD: TIBStringField;
    TLojaUsuRELABERTORD: TIBStringField;
    TLojaUsuRELFECHORD: TIBStringField;
    TLojaUsuCADBENSCLI: TIBStringField;
    TLojaUsuRELINVENTEST: TIBStringField;
    TLojaUsuDESCPED: TIBStringField;
    TLojaUsuDESCPMAIOR: TIBStringField;
    TLojaUsuACEFCHTECPROD: TIBStringField;
    TEtqProd: TIBQuery;
    UEtqProd: TIBUpdateSQL;
    DEtqProd: TDataSource;
    TLojaUsuUSAGARANT: TIBStringField;
    TLojaUsuACEPRODUCAO: TIBStringField;
    TLojaUsuCANCPEDFECH: TIBStringField;
    TLojaUsuALTBCCOMIS: TIBStringField;
    TLojaUsuALTCOMIS: TIBStringField;
    TReg: TIBQuery;
    UPReg: TIBUpdateSQL;
    DReg: TDataSource;
    TRegCOD_REGISTRO: TIntegerField;
    TRegDATA: TDateField;
    TRegHORA: TTimeField;
    TRegCOD_USUARIO: TIntegerField;
    TRegUSUARIO: TIBStringField;
    TRegMODULO: TIBStringField;
    TRegCOMANDO: TIBStringField;
    TRegDT_MODULO: TDateField;
    TRegTEXTO: TIBStringField;
    TRegFIELD1: TIBStringField;
    TLojaUsuECF: TIBStringField;
    TMens: TIBQuery;
    UMens: TIBUpdateSQL;
    DMens: TDataSource;
    TMensCOD_MENSAGEM: TIntegerField;
    TMensCOD_DE: TIntegerField;
    TMensDT_ENVIO: TDateField;
    TMensHR_ENVIO: TTimeField;
    TMensCOD_PARA: TIntegerField;
    TMensMENSAGEM: TIBStringField;
    TMensDT_SHOW: TDateField;
    TMensHR_SHOW: TTimeField;
    TMensSHOW: TIBStringField;
    TAlxMens: TIBQuery;
    IntegerField1: TIntegerField;
    IntegerField2: TIntegerField;
    DateField1: TDateField;
    TimeField1: TTimeField;
    IntegerField3: TIntegerField;
    IBStringField1: TIBStringField;
    DateField2: TDateField;
    TimeField2: TTimeField;
    IBStringField2: TIBStringField;
    DAlxMens: TDataSource;
    TLojaUsuALTVLRUNIPED: TIBStringField;
    TMP: TIBQuery;
    UTMP: TIBUpdateSQL;
    DTMP: TDataSource;
    TRel: TIBQuery;
    DSRel: TDataSource;
    TMPDESC2: TIBStringField;
    TMPVLR1: TIBBCDField;
    TMPVLR2: TIBBCDField;
    TMPCOD_TMP: TIntegerField;
    TMPINT1: TIntegerField;
    TMPDATA1: TDateField;
    TMPVLR3: TIBBCDField;
    TMPVLR4: TIBBCDField;
    TMPDESC1: TIBStringField;
    TMPVLR5: TIBBCDField;
    TMPVLR6: TIBBCDField;
    TLojaUsuREIMPDUP: TIBStringField;
    TMPVLR7: TIBBCDField;
    TLojaUsuBAIXACTABANCO: TIBStringField;
    TNF: TIBQuery;
    UNF: TIBUpdateSQL;
    DNF: TDataSource;
    TNFCOD_NF: TIntegerField;
    TNFCAMPO: TIBStringField;
    TNFCOLUNA: TSmallintField;
    TNFLINHA: TSmallintField;
    TNFFONTE: TSmallintField;
    TMPDATA2: TDateField;
    TLojaUsuMARGEMSEG: TIBStringField;
    TNFTAMANHO: TSmallintField;
    TNFALINHAR: TIBStringField;
    TMPINT2: TIntegerField;
    TMPINT3: TIntegerField;
    TUsuarioCODUSUARIO: TIntegerField;
    TUsuarioCOD_FUNCIONARIO: TIntegerField;
    TUsuarioLOGIN: TIBStringField;
    TUsuarioSENHA: TIBStringField;
    TUsuarioDATA_CAD: TDateField;
    TUsuarioADM: TIBStringField;
    TUsuarioREVRESMOV: TIBStringField;
    TLojaUsuTELACOMIS: TIBStringField;
    Transaction: TIBTransaction;
    TLoja: TIBQuery;
    UPLoja: TIBUpdateSQL;
    DSLoja: TDataSource;
    TEtqProdCOD_ETQPROD: TIntegerField;
    TEtqProdDESCRICAO: TIBStringField;
    TEtqProdALTPAG: TIBBCDField;
    TEtqProdLARGPAG: TIBBCDField;
    TEtqProdQTDETQPAG: TIBBCDField;
    TEtqProdLINHAINI: TIntegerField;
    TEtqProdCOLUNAINI: TIntegerField;
    TEtqProdQTDCOLPAG: TIntegerField;
    TEtqProdLARGCODBARRA: TIntegerField;
    TEtqProdCOMPCODBARRA: TIntegerField;
    TEtqProdINTERVLINHA: TIntegerField;
    TEtqProdINTERVCOL: TIntegerField;
    TEtqProdTAMFONTE: TSmallintField;
    TEtqProdTAMDESC: TSmallintField;
    TItemEtqProd: TIBQuery;
    UItemEtqProd: TIBUpdateSQL;
    DItemEtqProd: TDataSource;
    TItemEtqProdCOD_ITENSETQPROD: TIntegerField;
    TItemEtqProdCAMPO: TIBStringField;
    TItemEtqProdCOLUNA: TSmallintField;
    TItemEtqProdLINHA: TSmallintField;
    TItemEtqProdFONTE: TSmallintField;
    TItemEtqProdTAMANHO: TSmallintField;
    TItemEtqProdALINHAR: TIBStringField;
    TItemEtqProdCOD_ETQPROD: TIntegerField;
    TItemEtqProdNOMEFONTE: TIBStringField;
    TConfigDup: TIBQuery;
    UConfigDup: TIBUpdateSQL;
    DConfigDup: TDataSource;
    TConfigDupCOD_CONFIGDUP: TIntegerField;
    TConfigDupDESCRICAO: TIBStringField;
    TConfigDupALTPAG: TIBBCDField;
    TConfigDupLARGPAG: TIBBCDField;
    TConfigDupQTDETQPAG: TIBBCDField;
    TConfigDupLINHAINI: TIntegerField;
    TConfigDupCOLUNAINI: TIntegerField;
    TConfigDupQTDCOLPAG: TIntegerField;
    TConfigDupLARGCODBARRA: TIntegerField;
    TConfigDupCOMPCODBARRA: TIntegerField;
    TConfigDupINTERVLINHA: TIntegerField;
    TConfigDupINTERVCOL: TIntegerField;
    TConfigDupTAMFONTE: TSmallintField;
    TConfigDupTAMDESC: TSmallintField;
    TItensDupPerson: TIBQuery;
    UItensDupPerson: TIBUpdateSQL;
    DItensDupPerson: TDataSource;
    TItensDupPersonCOD_ITENSDUPPERSON: TIntegerField;
    TItensDupPersonCAMPO: TIBStringField;
    TItensDupPersonCOLUNA: TSmallintField;
    TItensDupPersonLINHA: TSmallintField;
    TItensDupPersonFONTE: TSmallintField;
    TItensDupPersonTAMANHO: TSmallintField;
    TItensDupPersonALINHAR: TIBStringField;
    TItensDupPersonCOD_DUPPERSON: TIntegerField;
    TItensDupPersonNOMEFONTE: TIBStringField;
    TLojaUsuABREGAVETA: TIBStringField;
    TConfigCheque: TIBQuery;
    TConfigChequeCOD_CONFIGCHEQUE: TIntegerField;
    TConfigChequeDESCRICAO: TIBStringField;
    TConfigChequeALTPAG: TIBBCDField;
    TConfigChequeLARGPAG: TIBBCDField;
    TConfigChequeQTDCHEQUEPAG: TIBBCDField;
    TConfigChequeLINHA_INI: TIntegerField;
    TConfigChequeENT_LINHA: TIntegerField;
    UConfigCheque: TIBUpdateSQL;
    DConfigCheque: TDataSource;
    TItensCheque: TIBQuery;
    TItensChequeCOD_ITENSCONFIG_CHEQUE: TIntegerField;
    TItensChequeLINHA: TSmallintField;
    TItensChequeCOLUNA: TSmallintField;
    TItensChequeNOME_FONTE: TIBStringField;
    TItensChequeTAMANHO_FONTE: TIntegerField;
    TItensChequeCAMPO: TIBStringField;
    TItensChequeCOD_CONFIGCHEQUE: TIntegerField;
    TItensChequeTAMANHO_CAMPO: TIntegerField;
    UItensCheque: TIBUpdateSQL;
    TLojaUsuGERAFINANC: TIBStringField;
    DItensCheque: TDataSource;
    TEmpresa: TIBQuery;
    UEMPRESA: TIBUpdateSQL;
    DsEmpresa: TDataSource;
    TEmpresaCOD_EMPRESA: TIntegerField;
    TEmpresaNUM_FILIAL: TIntegerField;
    TEmpresaFANTASIA: TIBStringField;
    TEmpresaRAZAO_SOCIAL: TIBStringField;
    TEmpresaCOD_CIDADE: TIntegerField;
    TEmpresaTIPO: TIBStringField;
    TEmpresaENDERECO: TIBStringField;
    TEmpresaBAIRRO: TIBStringField;
    TEmpresaCEP: TIBStringField;
    TEmpresaCX_POSTAL: TIBStringField;
    TEmpresaCNPJ: TIBStringField;
    TEmpresaINSC_EST: TIBStringField;
    TEmpresaDATA_FUNDACAO: TDateField;
    TEmpresaINSC_MUN: TIBStringField;
    TEmpresaWEB_PAGE: TIBStringField;
    TEmpresaPROX_NF: TIntegerField;
    TEmpresaCAD_SRF: TIBStringField;
    TEmpresaICMS: TFloatField;
    TEmpresaISSQN: TFloatField;
    TEmpresaCVVPROAT: TIBBCDField;
    TEmpresaCVPPROAT: TIBBCDField;
    TEmpresaCVVPROVAR: TIBBCDField;
    TEmpresaCVPPROVAR: TIBBCDField;
    TEmpresaAVVPROAT: TIBBCDField;
    TEmpresaAVPPROAT: TIBBCDField;
    TEmpresaAVVPROVAR: TIBBCDField;
    TEmpresaAVPPROVAR: TIBBCDField;
    TEmpresaIMPFED: TIBBCDField;
    TEmpresaIMPEST: TIBBCDField;
    TEmpresaCOD_MOEDA: TIntegerField;
    TEmpresaZEROCODPESSOA: TIBStringField;
    TEmpresaNCASASZEROPES: TIntegerField;
    TEmpresaPROXPEDVEND: TIBStringField;
    TEmpresaPROXPEDCOMP: TIBStringField;
    TEmpresaFONE: TIBStringField;
    TEmpresaNUMERO: TIBStringField;
    TEmpresaCONTATO: TIBStringField;
    TEmpresaPROX_OS: TIBStringField;
    TEmpresaPROXORC: TIBStringField;
    TEmpresaJUROSBOLET: TIBBCDField;
    TEmpresaCREDITAIPI: TIBStringField;
    TEmpresaCALCULAIPI: TIBStringField;
    TEmpresaTIPOEMPRESA: TIBStringField;
    TEmpresaPROXLICITA: TIBStringField;
    TEmpresaTEL0800: TIBStringField;
    TEmpresaCONTICMS: TIBStringField;
    TLojaUsuFECHAAUTOPED: TIBStringField;
    TEmpresaTIPOEMPRESANF: TIBStringField;
    TDocFiscFatura: TIBQuery;
    UDocFiscFatura: TIBUpdateSQL;
    DDocFiscFatura: TDataSource;
    TCodigoCOD_ABCAIXA: TIntegerField;
    TCodigoCOD_AGENCIA: TIntegerField;
    TCodigoCOD_BANC: TIntegerField;
    TCodigoCOD_CAIXA: TIntegerField;
    TCodigoCOD_CARGO: TIntegerField;
    TCodigoCOD_CFOP: TIntegerField;
    TCodigoCOD_CHEQUEMIT: TIntegerField;
    TCodigoCOD_CHEQUEREC: TIntegerField;
    TCodigoCOD_CIDADE: TIntegerField;
    TCodigoCOD_CLIENTE: TIntegerField;
    TCodigoCOD_CONFAPARENC: TIntegerField;
    TCodigoCOD_COTA: TIntegerField;
    TCodigoCOD_CST: TIntegerField;
    TCodigoCOD_CTACOR: TIntegerField;
    TCodigoCOD_CTACORFIL: TIntegerField;
    TCodigoCOD_CTAPAGAR: TIntegerField;
    TCodigoCOD_CTARECEBER: TIntegerField;
    TCodigoCOD_DOCFIS: TIntegerField;
    TCodigoCOD_EMAIL: TIntegerField;
    TCodigoCOD_EMPRESA: TIntegerField;
    TCodigoCOD_ESTADO: TIntegerField;
    TCodigoCOD_ESTOQUE: TIntegerField;
    TCodigoCOD_FORMPAG: TIntegerField;
    TCodigoCOD_FORNEC: TIntegerField;
    TCodigoCOD_FUNCARGO: TIntegerField;
    TCodigoCOD_FUNC: TIntegerField;
    TCodigoCOD_GRUPOPROD: TIntegerField;
    TCodigoCOD_ITENSPEDC: TIntegerField;
    TCodigoCOD_ITENSPEDVEN: TIntegerField;
    TCodigoCOD_LANC: TIntegerField;
    TCodigoCOD_LANENT: TIntegerField;
    TCodigoCOD_LANCSAI: TIntegerField;
    TCodigoCOD_LOJA: TIntegerField;
    TCodigoCOD_LOJAACES: TIntegerField;
    TCodigoCOD_MOEDA: TIntegerField;
    TCodigoCOD_MOVBANCO: TIntegerField;
    TCodigoCOD_PARCELACP: TIntegerField;
    TCodigoCOD_PARCELACR: TIntegerField;
    TCodigoCOD_PEDCOMP: TIntegerField;
    TCodigoCOD_PEDVENDA: TIntegerField;
    TCodigoCOD_PESSOA: TIntegerField;
    TCodigoCOD_PESSOAF: TIntegerField;
    TCodigoCOD_PESSOAJ: TIntegerField;
    TCodigoCOD_PLNCTA: TIntegerField;
    TCodigoCOD_PRODUTO: TIntegerField;
    TCodigoCOD_REGIAO: TIntegerField;
    TCodigoCOD_SALARIO: TIntegerField;
    TCodigoCOD_SUBGRUPOPROD: TIntegerField;
    TCodigoCOD_SUBPRODUTO: TIntegerField;
    TCodigoCOD_TELEFONE: TIntegerField;
    TCodigoCOD_UNIDADE: TIntegerField;
    TCodigoCODUSUARIO: TIntegerField;
    TCodigoCOD_CAIXAUSU: TIntegerField;
    TCodigoGENERATOR1: TIBStringField;
    TCodigoGENERATOR2: TIBStringField;
    TCodigoCOD_SERVOT: TIntegerField;
    TCodigoCOD_SERVICO: TIntegerField;
    TCodigoCOD_SUBSERVICO: TIntegerField;
    TCodigoCOD_EQUIPAMENTO: TIntegerField;
    TCodigoCOD_ORDEM: TIntegerField;
    TCodigoCOD_ITPRODORD: TIntegerField;
    TCodigoCOD_ITSERVORD: TIntegerField;
    TCodigoCOD_COMPROD: TIntegerField;
    TCodigoCOD_COMSERV: TIntegerField;
    TCodigoCOD_FCHTECPROD: TIntegerField;
    TCodigoCOD_ITFCHTECPROD: TIntegerField;
    TCodigoCOD_ITFCHTECSERV: TIntegerField;
    TCodigoCOD_ETQPROD: TIntegerField;
    TCodigoCOD_DESPADIC: TIntegerField;
    TCodigoCOD_PRODUCAO: TIntegerField;
    TCodigoCOD_IPRDMAO: TIntegerField;
    TCodigoCOD_IPRDMAT: TIntegerField;
    TCodigoCOD_DOCFISC: TIntegerField;
    TCodigoCOD_CONVUNID: TIntegerField;
    TCodigoCOD_COMISSAO: TIntegerField;
    TCodigoCOD_REGISTRO: TIntegerField;
    TCodigoCOD_R60: TIntegerField;
    TCodigoCOD_ORCAMENTO: TIntegerField;
    TCodigoCOD_ITPRODORC: TIntegerField;
    TCodigoCOD_ITSERVORC: TIntegerField;
    TCodigoCOD_MENSAGEM: TIntegerField;
    TCodigoCOD_LOTE: TIntegerField;
    TCodigoCOD_TMP: TIntegerField;
    TCodigoCOD_DOCFISSAIDA: TIntegerField;
    TCodigoCOD_NF: TIntegerField;
    TCodigoCOD_ITPRODLICITA: TIntegerField;
    TCodigoCOD_LICITA: TIntegerField;
    TCodigoCOD_DOCFISCORD: TIntegerField;
    TCodigoCOD_ITENSETQPROD: TIntegerField;
    TCodigoCOD_CLIENTECOB: TIntegerField;
    TCodigoCOD_AGENDA: TIntegerField;
    TCodigoCOD_CONTATO: TIntegerField;
    TCodigoCOD_DEVCLI: TIntegerField;
    TCodigoCOD_ABBANCO: TIntegerField;
    TCodigoCOD_CONFIGDUP: TIntegerField;
    TCodigoCOD_ITENSDUPPERSON: TIntegerField;
    TCodigoCOD_CREDITO: TIntegerField;
    TCodigoCOD_ENTREGA: TIntegerField;
    TCodigoCOD_ITEMENTREGA: TIntegerField;
    TCodigoCOD_CONFIGCHEQUE: TIntegerField;
    TCodigoCOD_ITENSCONFIG_CHEQUE: TIntegerField;
    TCodigoCOD_TABELAPRECO: TIntegerField;
    TCodigoCOD_ITEMTAB: TIntegerField;
    TCodigoCOD_LOCACAO: TIntegerField;
    TDocFiscFaturaCOD_DOCFISCFATURA: TIntegerField;
    TDocFiscFaturaCOD_DOCFISCAL: TIntegerField;
    TDocFiscFaturaCOD_PEDIDO: TIntegerField;
    TDocFiscFaturaTIPO: TIBStringField;
    TCodigoCOD_EQUIPE: TIntegerField;
    TCodigoCOD_FUNEQUIPE: TIntegerField;
    TCodigoCOD_DOCFISCFATURA: TIntegerField;
    FSRel: TfrReport;
    FDSCaixa: TfrDBDataSet;
    TLojaCOD_LOJA: TIntegerField;
    TLojaCOD_EMPRESA: TIntegerField;
    TLojaDESCRICAO: TIBStringField;
    TLojaMULTA: TFloatField;
    TLojaJUROS: TFloatField;
    TLojaGERENTE: TIBStringField;
    TLojaPLNCTA_RETCAI: TIntegerField;
    TLojaNCASASZEROPROD: TIntegerField;
    TLojaZEROCODPRODUTO: TIBStringField;
    TLojaFECHAPED: TIBStringField;
    TLojaATUAESTOQUE: TIBStringField;
    TLojaVENDESTNEG: TIBStringField;
    TLojaVENDSALDONEG: TIBStringField;
    TLojaTITULOPRIM: TIBStringField;
    TLojaTITULOSEC: TIBStringField;
    TLojaRODAPEPED: TIBStringField;
    TLojaFONTTITPRIM: TIntegerField;
    TLojaFONTTITSEC: TIntegerField;
    TLojaFONTRODAPE: TIntegerField;
    TLojaIMPPED: TIBStringField;
    TLojaQTDCOPYPED: TIntegerField;
    TLojaTEXTODUPREC: TBlobField;
    TLojaIMPPEDFECH: TIBStringField;
    TLojaIMPDUP: TIBStringField;
    TLojaIMPDUPAUT: TIBStringField;
    TLojaCALVALVEND: TIBStringField;
    TLojaPLNCTA_LANCINI: TIntegerField;
    TLojaCONTCPFCNPJCLI: TIBStringField;
    TLojaCONTCPFCNPJFOR: TIBStringField;
    TLojaFOCUITEMPED: TIBStringField;
    TLojaCAMPOPESQITEMPED: TIBStringField;
    TLojaPLNCTA_VENDVISTA: TIntegerField;
    TLojaPLNCTA_VENDPRAZO: TIntegerField;
    TLojaPLNCTA_COMPVISTA: TIntegerField;
    TLojaPLNCTA_COMPPRAZO: TIntegerField;
    TLojaATIVIDADE: TIBStringField;
    TLojaVENDITEMPROD: TIBStringField;
    TLojaJURCOMP: TIBStringField;
    TLojaIEPRECO: TIBStringField;
    TLojaIECODCOMPOSTO: TIBStringField;
    TLojaIEMARCA: TIBStringField;
    TLojaPLNCTA_JURCONCED: TIntegerField;
    TLojaPLNCTA_JURREC: TIntegerField;
    TLojaPLNCTA_DESCCONCED: TIntegerField;
    TLojaPLNCTA_DESCREC: TIntegerField;
    TLojaVALREP: TIBBCDField;
    TLojaIEDESC: TIBStringField;
    TLojaIECODFAB: TIBStringField;
    TLojaPLNCTA_SAICXCORR: TIntegerField;
    TLojaPLNCTA_ENTCXCORR: TIntegerField;
    TLojaCOD_CONSUMIDOR: TIntegerField;
    TLojaCAMIMGPDV: TIBStringField;
    TLojaDIASCARE: TIntegerField;
    TLojaISSQN: TIBBCDField;
    TLojaINSS: TIBBCDField;
    TLojaIMPREND: TIBBCDField;
    TLojaCONTSOC: TIBBCDField;
    TLojaPIS: TIBBCDField;
    TLojaCOFINS: TIBBCDField;
    TLojaOUTROIMPSERV: TIBBCDField;
    TLojaCOMISSAOSERV: TIBBCDField;
    TLojaTXTABERTORD: TMemoField;
    TLojaTXTFECHORD: TMemoField;
    TLojaPLNCTASERV: TIntegerField;
    TLojaPLNCTASERVPRAZO: TIntegerField;
    TLojaPROXCTRINT: TIBStringField;
    TLojaTIPOETPROD: TIBStringField;
    TLojaMOVPARCAVISTA: TIBStringField;
    TLojaUTILFORMPG: TIBStringField;
    TLojaCODPRODREL1: TIBStringField;
    TLojaCODPRODREL2: TIBStringField;
    TLojaALTCOMPROD: TIBStringField;
    TLojaETPERSONAL: TIBStringField;
    TLojaCOD_ETQPROD: TIntegerField;
    TLojaUSAMULTCOMIS: TIBStringField;
    TLojaDIASBLOQCLI: TIntegerField;
    TLojaCAMIMGLOGO: TIBStringField;
    TLojaTMP1: TMemoField;
    TLojaTMP2: TMemoField;
    TLojaUSAGARANTIA: TIBStringField;
    TLojaCOD_GRUPOMT: TIntegerField;
    TLojaCTAFRTCOMP: TIntegerField;
    TLojaCTAFRTVEND: TIntegerField;
    TLojaCONVERTUNID: TIBStringField;
    TLojaFRASEECF: TIBStringField;
    TLojaPORTAECF: TIBStringField;
    TLojaTIPOFISCAL: TIBStringField;
    TLojaENDREL: TIBStringField;
    TLojaPLNCTATRANSFBANCO: TIntegerField;
    TLojaPLNCTATRANSFCAIXA: TIntegerField;
    TLojaCTRLDVL: TIBStringField;
    TLojaCTRLMENS: TIBStringField;
    TLojaTIMEMENS: TIntegerField;
    TLojaPRIMTITCUPOM: TIBStringField;
    TLojaSEGTITCUPOM: TIBStringField;
    TLojaTERCTITCUPOM: TIBStringField;
    TLojaIMPOUTINFC: TIBStringField;
    TLojaNOMECAMPOAUXPROD: TIBStringField;
    TLojaCOMISSPRODCADPROD: TIBStringField;
    TLojaOPERADESCCUPOM: TIBStringField;
    TLojaTITULODESCCUPOM: TIBStringField;
    TLojaIEBARRA: TIBStringField;
    TLojaCTRLIMPCUPOMCX: TIBStringField;
    TLojaR50: TIBStringField;
    TLojaR51: TIBStringField;
    TLojaR53: TIBStringField;
    TLojaR54: TIBStringField;
    TLojaR55: TIBStringField;
    TLojaR56: TIBStringField;
    TLojaR60M: TIBStringField;
    TLojaR60MECF: TIBStringField;
    TLojaR60D: TIBStringField;
    TLojaR60I: TIBStringField;
    TLojaR60R: TIBStringField;
    TLojaR61: TIBStringField;
    TLojaR61R: TIBStringField;
    TLojaR70: TIBStringField;
    TLojaR71: TIBStringField;
    TLojaR74: TIBStringField;
    TLojaR75: TIBStringField;
    TLojaR76: TIBStringField;
    TLojaR77: TIBStringField;
    TLojaR88SF: TIBStringField;
    TLojaR88PN: TIBStringField;
    TLojaR88GT: TIBStringField;
    TLojaR60A: TIBStringField;
    TLojaR60AECF: TIBStringField;
    TLojaMODELONF: TIBStringField;
    TLojaSERIENF: TIBStringField;
    TLojaNFIMP: TIBStringField;
    TLojaNFENTLINPROD: TSmallintField;
    TLojaNFENTLINSERV: TSmallintField;
    TLojaNFTAMPAPLIN: TSmallintField;
    TLojaNFTAMPAPCOL: TSmallintField;
    TLojaNFITMAXPROD: TSmallintField;
    TLojaNFITMAXSERV: TSmallintField;
    TLojaNFENTLINRECIBO: TSmallintField;
    TLojaIMGMENU: TIBStringField;
    TLojaIMGMENUTRANSP: TIBStringField;
    TLojaIMGMENUEXPANDIR: TIBStringField;
    TLojaIMGMENUCENTRO: TIBStringField;
    TLojaIMGMENUPROPORC: TIBStringField;
    TLojaNFDADOSADIC: TIBStringField;
    TLojaDESCCAMPADIC: TIBStringField;
    TLojaMODELOORDEM: TSmallintField;
    TLojaREDE: TIBStringField;
    TLojaCOD_PRODDIV: TIntegerField;
    TLojaCOD_FORDEV: TIntegerField;
    TLojaPLNCTA_DEVOLUCAO: TIntegerField;
    TLojaCOD_CFOPDEV: TIntegerField;
    TLojaECFTRUNC: TIBStringField;
    TLojaPERCDEC: TIBBCDField;
    TLojaDIASDESC: TSmallintField;
    TLojaIEALTLARG: TIBStringField;
    TLojaIECOMPOSICAO: TIBStringField;
    TLojaIEPRECOPRAZO: TIBStringField;
    TLojaTMP3: TMemoField;
    TLojaIECLASS: TIBStringField;
    TLojaIEFABR: TIBStringField;
    TLojaIMPMATRICIAL: TIBStringField;
    TLojaCOD_IMPMAT: TIntegerField;
    TLojaMODELOORC: TSmallintField;
    TLojaCOD_CFOPAUTO: TIntegerField;
    TLojaPLNCTATRANSFCXCX: TIntegerField;
    TLojaTXTPED: TIBStringField;
    TLojaTIPODUPLICATA: TIntegerField;
    TLojaCOD_DUPPERSONAL: TIntegerField;
    TLojaPROXDOCCTAREC: TIBStringField;
    TLojaIMPTHERMAL: TIBStringField;
    TLojaBUSCANPRODS: TIBStringField;
    TLojaUSAGAVETA: TIBStringField;
    TLojaTEXTOGARANTIA: TMemoField;
    TLojaDESC_TAXA_DESLOCA: TIBStringField;
    TLojaVLR_TAXA: TIBBCDField;
    TLojaWWW_PROCON: TIBStringField;
    TLojaFONE_PROCON: TIBStringField;
    TLojaEND_PROCON: TIBStringField;
    TLojaCOD_CONFIGCHEQUE: TIntegerField;
    TLojaTIPORECIBO: TIBStringField;
    TLojaPAINEL_DESC: TIBStringField;
    TLojaTIPOVENDA: TIBStringField;
    TLojaPDVVLRUNIT: TIBStringField;
    TLojaORDEMLOCA_GUINDASTE: TIBStringField;
    TLojaGERAFINANCEIRO: TIBStringField;
    TLojaMODELOPEDVENDA: TSmallintField;
    TLojaTEXTOORCAMENTO: TMemoField;
    TLojaEXPORT_OS: TIBStringField;
    TLojaVISUALNF: TIBStringField;
    TLojaVISUALRS: TIBStringField;
    TLojaMODELOORDEMFECH: TSmallintField;
    TLojaREVELCUSTOPRODUTO: TSmallintField;
    TLojaMSGESTOQUEMIN: TIBStringField;
    TLojaMSGLIMITCRED: TIBStringField;
    TLojaCFOPINTERNO: TIntegerField;
    TLojaCFOPEXTERNO: TIntegerField;
    TLojaCOD_CTAANTECIPCREDCLI: TIntegerField;
    TLojaCOD_CTAANTECIPCREDFOR: TIntegerField;
    TLojaCFOPINTERNOCST: TIntegerField;
    TLojaCFOPEXPERTOCST: TIntegerField;
    TLojaNFEVERSASCHEMA: TIBStringField;
    TLojaNFEPROHOMO: TSmallintField;
    TLojaNFECERTIFICACAO: TIBStringField;
    TEmpresaNFEPROXLOTE: TIBStringField;
    TLojaNFELICENSA: TIBStringField;
    TCodigoCOD_ALUGUEL: TIntegerField;
    TCodigoCOD_MOTORISTAVEICULO: TSmallintField;
    TMPDESC3: TIBStringField;
    TEmpresaNFESERIE: TIntegerField;
    TLojaCONVERTUNIDVEND: TIBStringField;
    TLojaCALCESTESTRUT: TIBStringField;
    TLojaCONVERTUNIDFERRO: TIBStringField;
    TCodigoCOD_OBRA: TIntegerField;
    TMPVLR8: TIBBCDField;
    TLojaNFENTLINDESP: TSmallintField;
    TLojaNFITMAXDESP: TSmallintField;
    TLojaECFINDICEALIQSERV: TIBStringField;
    procedure EVENTEventAlert(Sender: TObject; EventName: String;
      EventCount: Integer; var CancelAlerts: Boolean);
    procedure DataModuleCreate(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
    Procedure SelectLojaUsu(CodUsuario:Integer);//Seleciona lojas de acordo com usuario acesso

  end;

var
  DMMACS: TDMMACS;

implementation

uses UMenu;

{$R *.DFM}

//Seleciona lojas de acordo com usuario acesso
Procedure TDMMACS.SelectLojaUsu(CodUsuario:Integer);
Begin
    DMMacs.TALX.Close;
    DMMacs.TALX.SQL.Clear;
    DMMacs.TALX.sql.Add('SELECT loja.cod_loja, loja.descricao, empresa.cod_empresa, empresa.fantasia, usuario.codusuario, LojaCesso.COD_LOJAACES ');
    DMMacs.TALX.SQL.Add('FROM LOJA JOIN lojacesso ON loja.cod_loja=lojacesso.cod_loja ');
    DMMacs.TALX.SQL.Add(' JOIN usuario on lojacesso.cod_usuario=usuario.codusuario ');
    DMMacs.TALX.SQL.Add(' JOIN empresa ON loja.cod_empresa=empresa.cod_empresa');
    DMMacs.TALX.SQL.Add(' Where Usuario.CodUsuario=:CodigoUsuario');
    DMMacs.TALX.ParamByName('CodigoUsuario').AsInteger:=CodUsuario;
    DMMacs.TALX.Open;
End;

procedure TDMMACS.EVENTEventAlert(Sender: TObject; EventName: String;
  EventCount: Integer; var CancelAlerts: Boolean);
begin
{***    ShowMessage('EVENTO: '+EventName);***}
end;

procedure TDMMACS.DataModuleCreate(Sender: TObject);
begin
//    EMACS.Registered:=TRUE;
end;

end.
